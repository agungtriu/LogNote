<%- include('../layouts/header.ejs'); -%>

<section class="message">
  <% if(message.length > 0) { %>
  <div class="alert alert-success"><%= message %></div>
  <% } %> <% if(error.length > 0) { %>
  <div class="alert alert-danger"><%= error %></div>
  <% } %>
</section>

<section class="text-center">
  <h2 class="my-4 fw-semibold">Project List</h2>
</section>

<section class="container">
  <a class="btn btn-dark" href="/projects/create">Create Project</a>
  <section class="d-flex justify-content-center">
    <table class="table table-bordered text-center mt-2">
      <thead>
        <tr class="table-dark">
          <th>ID</th>
          <th>NAME</th>
          <th>DESCRIPTION</th>
          <th>REPOSITORY</th>
          <th>USERS</th>
          <th>ACTIONS</th>
        </tr>
      </thead>
      <tbody>
        <% if (projects.length) { %> <% projects.forEach(project => { %>
        <tr>
          <td><%= project.id %></td>
          <td><%= project.name %></td>
          <td><%= project.description %></td>
          <td>
            <a href="<%= project.repository %>" target="_blank"><u>Link</u></a>
          </td>
          <td>
            <% project.users.forEach((user, idx, arr) => { %> <% if (idx
            !==arr.length - 1) { %> <%= user.name %>, <%} else { %> <%=
            user.name %> <% } %> <% }) %>
          </td>
          <td>
            <a href="/projects/edit/<%=project.id%>"
              ><i class="fa-solid fa-pen-to-square me-2"></i
            ></a>
            <a href="/projects/delete/<%=project.id%>"
              ><i class="fa-solid fa-trash ms-2"></i
            ></a>
          </td>
        </tr>
        <% }) %> <% } else {%>
        <tr>
          <td class="text-center" colspan="6">
            Projects are empty! Insert some data.
          </td>
        </tr>
        <% } %>
      </tbody>
    </table>
  </section>
</section>

<%- include('../layouts/script.ejs'); -%>
